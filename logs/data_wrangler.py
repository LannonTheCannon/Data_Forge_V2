# Disclaimer: This function was generated by AI. Please review before using.
# Agent Name: data_wrangling_agent
# Time Created: 2025-04-16 20:20:37

def data_wrangler(data_list):
    import pandas as pd
    import numpy as np
    '''
    Wrangle the data provided in data_list and prepare summary for plotting.
    '''


    # Ensure data_list is a list
    if not isinstance(data_list, list):
        data_list = [data_list]
    
    # Concatenate all dataframes in the list into a single dataframe
    df = pd.concat(data_list, ignore_index=True)
    
    # Step 2: Verify data types and check for missing or inconsistent values
    # Check for missing values in relevant columns
    # We'll focus on 'OffenderStatus' and 'Offender_Gender'
    # Drop rows with missing or invalid values in these columns
    df_clean = df.dropna(subset=['OffenderStatus', 'Offender_Gender'])
    
    # Optional: Standardize data types if needed (not strictly necessary here as columns are objects)
    # Confirm the columns are of object type
    # (Assuming data is consistent; if needed, can cast explicitly)
    # df_clean['OffenderStatus'] = df_clean['OffenderStatus'].astype(str)
    # df_clean['Offender_Gender'] = df_clean['Offender_Gender'].astype(str)
    
    # Step 4: Group the data by 'Offender_Gender' and count the number of occurrences for each
    counts = df_clean.groupby('Offender_Gender').size().reset_index(name='Count')
    
    # Step 5: Prepare data for plotting
    # The 'counts' DataFrame now has 'Offender_Gender' and 'Count' columns
    
    # Return the summarized DataFrame
    return counts