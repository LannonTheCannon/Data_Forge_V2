# Disclaimer: This function was generated by AI. Please review before using.
# Agent Name: data_wrangling_agent
# Time Created: 2025-04-16 20:38:12

def data_wrangler(data_list):
    import pandas as pd
    import numpy as np
    '''
    Wrangle the data provided in data_list.

    data_list: A list of one or more pandas data frames containing the raw data to be wrangled.
    '''


    # Ensure input is a list of DataFrames
    if not isinstance(data_list, list):
        data_list = [data_list]

    # Assuming the main dataset is always the first in the list
    main = data_list[0].copy()

    # Step 1: Select only relevant columns
    cols_to_use = ['Offender_Gender', 'OffenderStatus']
    df = main[cols_to_use].copy()

    # Step 2: Standardize column names if needed (should already be correct)

    # Step 3: Handle inconsistent/missing values in Offender_Gender and OffenderStatus
    # We'll treat 'UNKNOWN', empty strings, and NaN as a single category: 'UNKNOWN/NA'
    for col in cols_to_use:
        df[col] = df[col].replace(['', 'UNKNOWN', None, np.nan], 'UNKNOWN/NA')
        df[col] = df[col].fillna('UNKNOWN/NA')  # Just in case any slipped through

    # Step 4: Group by Offender_Gender and OffenderStatus
    grouped = (
        df.groupby(['Offender_Gender', 'OffenderStatus'])
          .size()
          .reset_index(name='RecordCount')
    )

    # Step 5: Sort by RecordCount descending (optional but recommended)
    grouped = grouped.sort_values('RecordCount', ascending=False).reset_index(drop=True)

    # Step 6: Return the final grouped and counted DataFrame
    return grouped