# Disclaimer: This function was generated by AI. Please review before using.
# Agent Name: data_wrangling_agent
# Time Created: 2025-04-28 12:23:43

def data_wrangler(data_list):
    import pandas as pd
    import numpy as np
    '''
    Wrangle the data provided in data_list.
    
    data_list: A list of one or more pandas data frames containing the raw data to be wrangled.
               If a single DataFrame is passed instead of list, it will be converted to list.
    '''


    # Ensure input is a list (to handle single DataFrame input as well)
    if not isinstance(data_list, list):
        data_list = [data_list]
    
    # Since user instructions and dataset summary indicate only one dataset "main" is provided,
    # we will assume the relevant dataframe is the first in the list.
    # If multiple datasets are provided, merging logic would be required here.
    df = data_list[0].copy()
    
    # Step 1: Check for missing values in 'Month', 'Day of Week', and 'Total Sales'
    # We will drop rows with missing values in these columns to ensure accuracy in grouping.
    df = df.dropna(subset=['Month', 'Day of Week', 'Total Sales'])
    
    # Step 2 & 3: Group by 'Month' and 'Day of Week' and calculate average of 'Total Sales'
    grouped = df.groupby(['Month', 'Day of Week'], as_index=False)['Total Sales'].mean()
    
    # Step 4: Reset index is done by as_index=False in groupby
    
    # Step 5 (Optional): Sort by 'Month' and 'Day of Week' for better readability
    grouped = grouped.sort_values(by=['Month', 'Day of Week']).reset_index(drop=True)
    
    # Rename 'Total Sales' to 'Average Total Sales' for clarity
    grouped.rename(columns={'Total Sales': 'Average Total Sales'}, inplace=True)
    
    # Return the final wrangled DataFrame
    return grouped