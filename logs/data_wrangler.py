# Disclaimer: This function was generated by AI. Please review before using.
# Agent Name: data_wrangling_agent
# Time Created: 2025-04-17 20:10:12

def data_wrangler(data_list):
    import pandas as pd
    import numpy as np
    '''
    Wrangle the data provided in data_list.

    data_list: A list of one or more pandas data frames containing the raw data to be wrangled.
    '''


    # Ensure data_list is a list even if a single DataFrame is passed
    if not isinstance(data_list, list):
        data_list = [data_list]

    # According to the problem statement, there is only one dataset named 'main'
    # So we take the first DataFrame from the list
    main = data_list[0]

    # Step 1: Identify the item column - "Sub-Category" as item identifier
    
    # Step 2-4: Group by 'Sub-Category' and aggregate total Quantity and Amount
    summary = main.groupby('Sub-Category').agg({
        'Quantity': 'sum',
        'Amount': 'sum'
    }).reset_index()

    # Step 5: Find the sub-category with the highest total quantity sold
    most_sold_item = summary.loc[summary['Quantity'].idxmax()]

    # Step 6: Create a summary table with each Sub-Category, total quantity sold and total sales amount
    # Add a column to indicate which item is the most sold item for clarity
    summary['Most_Sold_Item_Flag'] = np.where(
        summary['Sub-Category'] == most_sold_item['Sub-Category'], True, False
    )

    # Optionally, add the most sold item name and its quantity and total amount as additional rows or columns
    # But since user requested to show both most sold item and total sales of all items,
    # returning summary with a flag column suffices to identify the most sold item.

    # Return the summary DataFrame
    return summary